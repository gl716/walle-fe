webpackJsonp([5],{PjKT:function(e,n){},pb05:function(e,n){},sroI:function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=t("Dd8w"),i=t.n(r),o=t("Xxa5"),a=t.n(o),s=t("exGp"),l=t.n(s),c=t("xhV0"),u={props:{visible:{type:Boolean,default:!1},environment:Object},data:function(){return{error:this.initError(),form:this.initForm(),rules:{env_name:[{required:!0,message:"请输入环境名称",trigger:"blur"}]}}},watch:{environment:function(e){if(this.visible)if(e){var n=e.env_name;this.form.env_name=n}else this.form=this.initForm()}},computed:{isNew:function(){return!this.environment}},methods:{onOk:function(){var e=this;this.$refs.form.validate(function(n){if(!n)return!1;e.sendData()})},onCancel:function(){this.$emit("update:visible"),this.$emit("close")},initForm:function(){return{env_name:""}},initError:function(){return{env_name:""}},sendData:function(){var e=this;return l()(a.a.mark(function n(){var t,r;return a.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(n.prev=0,e.error=e.initError(),n.t0=e.isNew,!n.t0){n.next=6;break}return n.next=6,Object(c.a)(e.form);case 6:if(n.t1=e.isNew,n.t1){n.next=10;break}return n.next=10,Object(c.d)(e.environment.id,i()({},e.form,{status:e.environment.status}));case 10:e.$emit("update:visible"),e.$emit("confirm"),n.next=19;break;case 14:if(n.prev=14,n.t2=n.catch(0),n.t2.code,t=n.t2.message)for(r in t)e.error[r]=t[r][0];case 19:case"end":return n.stop()}},n,e,[[0,14]])}))()}}},m={render:function(){var e=this,n=e.$createElement,t=e._self._c||n;return t("el-dialog",{staticClass:"wl-add-environment",attrs:{width:"600px",title:e.isNew?"新增环境":"编辑环境",visible:e.visible,"before-close":e.onCancel,"append-to-body":!0}},[t("el-form",{ref:"form",attrs:{model:e.form}},[t("el-form-item",{attrs:{label:"名称","label-width":"120px",prop:"env_name",rules:e.rules.env_name,error:e.error.env_name}},[t("el-input",{attrs:{size:"small","auto-complete":"off"},model:{value:e.form.env_name,callback:function(n){e.$set(e.form,"env_name",n)},expression:"form.env_name"}})],1)],1),e._v(" "),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.onOk}},[e._v("确定")]),e._v(" "),t("el-button",{attrs:{size:"small"},on:{click:e.onCancel}},[e._v("取消")])],1)],1)},staticRenderFns:[]};var v={name:"project-environment",components:{addEnvironmentDialog:t("VU/8")(u,m,!1,function(e){t("pb05")},null,null).exports},data:function(){return{value:"",columns:function(){var e=this;return[{label:"名称",width:250,prop:"env_name"},{label:"状态",width:250,prop:"status"},{label:"操作",minWidth:200,render:function(n,t,r){return e.renderTools(t)}}]}.call(this),currentEditEnvironment:null,addEnvironmentDialogVisible:!1}},methods:{callServe:function(){var e=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.$refs.table;return l()(a.a.mark(function t(){var r,i,o,s;return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(c.c)({size:n.page.size,page:n.page.currentPage,kw:e.value});case 2:r=t.sent,i=r.data,o=i.list,s=i.count,n.page.total=s,n.list=o;case 8:case"end":return t.stop()}},t,e)}))()},search:function(){this.callServe()},addEnvironment:function(){this.addEnvironmentDialogVisible=!0},edit:function(e){this.addEnvironmentDialogVisible=!0,this.currentEditEnvironment=i()({},e)},delete:function(e){var n=this;this.$confirm("确定删除该环境吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){n.deletEenvironment(e)}).catch(function(){})},deletEenvironment:function(e){var n=this;return l()(a.a.mark(function t(){return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(c.b)(e.id);case 2:n.callServe(),n.$message({type:"success",message:"删除成功!"});case 4:case"end":return t.stop()}},t,n)}))()},confirm:function(e){this.currentEditEnvironment=null,this.callServe()},close:function(){this.currentEditEnvironment=null},renderTools:function(e){var n=this,t=this.$createElement;return t("div",[t("el-button",{attrs:{type:"text",size:"small",icon:"el-icon-edit"},on:{click:function(){return n.edit(i()({},e.row))}}},["编辑"]),t("el-button",{attrs:{type:"text",size:"small",icon:"el-icon-delete"},class:"user-delete",on:{click:function(){return n.delete(i()({},e.row))}}},["删除"])])}}},f={render:function(){var e=this,n=e.$createElement,t=e._self._c||n;return t("div",{staticClass:"wl-environment"},[t("el-form",{attrs:{inline:!0},nativeOn:{submit:function(e){e.preventDefault()}}},[t("el-form-item",[t("el-input",{staticClass:"search",attrs:{placeholder:"请输入内容",size:"small"},nativeOn:{keyup:function(n){return"button"in n||!e._k(n.keyCode,"enter",13,n.key,"Enter")?e.search(n):null}},model:{value:e.value,callback:function(n){e.value=n},expression:"value"}},[t("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:e.search},slot:"append"})],1)],1),e._v(" "),t("el-form-item",[t("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-edit"},on:{click:e.addEnvironment}},[e._v("添加")])],1)],1),e._v(" "),t("wl-table",{ref:"table",attrs:{columns:e.columns},on:{callServe:e.callServe}}),e._v(" "),t("add-environment-dialog",{attrs:{visible:e.addEnvironmentDialogVisible,environment:e.currentEditEnvironment},on:{"update:visible":function(n){e.addEnvironmentDialogVisible=n},confirm:e.confirm,close:e.close}})],1)},staticRenderFns:[]};var d=t("VU/8")(v,f,!1,function(e){t("PjKT")},null,null);n.default=d.exports}});
//# sourceMappingURL=5.b17fa44bf3a73da93a83.js.map