webpackJsonp([7],{N17M:function(e,r){},iufH:function(e,r){},m9Po:function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var s=t("Dd8w"),i=t.n(s),n=t("Xxa5"),a=t.n(n),l=t("exGp"),o=t.n(l),u=t("4MTg"),c=t("diZN");function d(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Object(c.b)("role/",e,i()({},r,{isRemoveField:!0}))}var m={props:{visible:{type:Boolean,default:!1},user:Object},data:function(){return{roles:[],error:this.initError(),form:this.initForm(0),updatePasswordRules:[{pattern:/(?=\d{0,}[a-zA-Z])(?=[a-zA-Z]{0,}\d)[a-zA-Z0-9]{6,}/,message:"密码强度不足",trigger:"blur"}],rules:{email:[{required:!0,message:"请输入邮箱地址",trigger:"blur"},{type:"email",message:"请输入正确的邮箱地址",trigger:"blur"}],password:[{required:!0,message:"请设置密码",trigger:"blur"},{pattern:/(?=\d{0,}[a-zA-Z])(?=[a-zA-Z]{0,}\d)[a-zA-Z0-9]{6,}/,message:"密码强度不足",trigger:"blur"}],username:[{required:!0,message:"请输入用户名",trigger:"blur"}],role_id:[{required:!0,message:"请选择用户角色",trigger:"blur"}]}}},watch:{visible:{immediate:!0,handler:function(e){e&&this.getRoles({},{target:".wl-add-user__option"})}},user:function(e){if(this.visible)if(e){var r=e.username,t=e.email,s=e.password,i=e.role_id;this.form.username=r,this.form.email=t,this.form.password=s,this.form.role_id=i}else this.form=this.initForm()}},computed:{isNew:function(){return!this.user}},methods:{getRoles:function(){var e=this;return o()(a.a.mark(function r(){var t,s;return a.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,d();case 2:t=r.sent,s=t.data.list,e.roles=s;case 5:case"end":return r.stop()}},r,e)}))()},onOk:function(){var e=this;this.$refs.form.validate(function(r){if(!r)return!1;e.sendData()})},onCancel:function(){this.$emit("update:visible"),this.$emit("close")},initForm:function(){return{email:"",password:"",username:"",role_id:null}},initError:function(){return{email:"",password:"",username:"",role_id:""}},sendData:function(){var e=this;return o()(a.a.mark(function r(){var t,s;return a.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(r.prev=0,e.error=e.initError(),r.t0=e.isNew,!r.t0){r.next=6;break}return r.next=6,Object(u.a)(e.form);case 6:if(r.t1=e.isNew,r.t1){r.next=10;break}return r.next=10,Object(u.e)(e.user.id,e.form);case 10:e.$emit("update:visible"),e.$emit("confirm"),r.next=19;break;case 14:if(r.prev=14,r.t2=r.catch(0),r.t2.code,t=r.t2.message)for(s in t)e.error[s]=t[s][0];case 19:case"end":return r.stop()}},r,e,[[0,14]])}))()}}},f={render:function(){var e=this,r=e.$createElement,t=e._self._c||r;return t("el-dialog",{staticClass:"wl-add-user",attrs:{width:"600px",title:e.isNew?"新增用户":"编辑用户",visible:e.visible,"before-close":e.onCancel,"append-to-body":!0}},[t("el-form",{ref:"form",attrs:{model:e.form}},[t("el-form-item",{attrs:{label:"用户名","label-width":"120px",prop:"username",rules:e.rules.username,error:e.error.username}},[t("el-input",{attrs:{size:"small","auto-complete":"off"},model:{value:e.form.username,callback:function(r){e.$set(e.form,"username",r)},expression:"form.username"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"邮箱","label-width":"120px",prop:"email",rules:e.isNew?e.rules.email:[],error:e.error.email}},[t("el-input",{attrs:{size:"small","auto-complete":"off",disabled:!e.isNew},model:{value:e.form.email,callback:function(r){e.$set(e.form,"email",r)},expression:"form.email"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"密码","label-width":"120px",prop:"password",rules:e.isNew?e.rules.password:e.updatePasswordRules,error:e.error.password}},[t("el-input",{attrs:{size:"small","auto-complete":"off"},model:{value:e.form.password,callback:function(r){e.$set(e.form,"password",r)},expression:"form.password"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"角色","label-width":"120px",prop:"role_id",rules:e.rules.role_id,error:e.error.role_id}},[t("el-select",{staticClass:"wl-add-user__option",attrs:{size:"small",placeholder:"请分配角色"},model:{value:e.form.role_id,callback:function(r){e.$set(e.form,"role_id",r)},expression:"form.role_id"}},e._l(e.roles,function(e){return t("el-option",{key:e.id,attrs:{label:e.role_name,value:e.id}})}))],1)],1),e._v(" "),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.onOk}},[e._v("确定")]),e._v(" "),t("el-button",{attrs:{size:"small"},on:{click:e.onCancel}},[e._v("取消")])],1)],1)},staticRenderFns:[]};var p={name:"user-list",components:{addUserDialog:t("VU/8")(m,f,!1,function(e){t("iufH")},null,null).exports},data:function(){return{value:"",columns:function(){var e=this;return[{label:"用户名",width:250,prop:"username"},{label:"角色",width:250,prop:"role_name"},{label:"状态",width:250,prop:"status"},{label:"操作",minWidth:200,render:function(r,t,s){return e.renderTools(t)}}]}.call(this),currentEditUser:null,addUserDialogVisible:!1}},methods:{callServe:function(){var e=this,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.$refs.table;return o()(a.a.mark(function t(){var s,i,n,l;return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(u.c)({size:r.page.size,page:r.page.currentPage,kw:e.value});case 2:s=t.sent,i=s.data,n=i.list,l=i.count,r.page.total=l,r.list=n;case 8:case"end":return t.stop()}},t,e)}))()},search:function(){this.callServe()},addUser:function(){this.addUserDialogVisible=!0},edit:function(e){this.addUserDialogVisible=!0,this.currentEditUser=i()({},e)},lock:function(e){var r=this;return o()(a.a.mark(function t(){return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(u.e)(e.id,{status:2,role_id:e.role_id,username:e.username});case 2:r.callServe();case 3:case"end":return t.stop()}},t,r)}))()},delete:function(e){var r=this;this.$confirm("确定删除该用户吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){r.deleteUser(e)}).catch(function(){})},deleteUser:function(e){var r=this;return o()(a.a.mark(function t(){return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(u.b)(e.id);case 2:r.callServe(),r.$message({type:"success",message:"删除成功!"});case 4:case"end":return t.stop()}},t,r)}))()},confirm:function(e){this.currentEditUser=null,this.callServe()},close:function(){this.currentEditUser=null},renderTools:function(e){var r=this,t=this.$createElement;return t("div",[t("el-button",{attrs:{type:"text",size:"small",icon:"el-icon-edit"},on:{click:function(){return r.edit(i()({},e.row))}}},["编辑"]),t("el-button",{attrs:{type:"text",size:"small",icon:"el-icon-delete"},class:"user-delete",on:{click:function(){return r.delete(i()({},e.row))}}},["删除"]),t("el-button",{attrs:{type:"text",size:"small",icon:"wl-icon-lock"},on:{click:function(){return r.lock(i()({},e.row))}}},["冻结"])])}}},v={render:function(){var e=this,r=e.$createElement,t=e._self._c||r;return t("div",{staticClass:"wl-user-list"},[t("el-form",{attrs:{inline:!0},nativeOn:{submit:function(e){e.preventDefault()}}},[t("el-form-item",[t("el-input",{staticClass:"search",attrs:{placeholder:"请输入内容",size:"small"},nativeOn:{keyup:function(r){return"button"in r||!e._k(r.keyCode,"enter",13,r.key,"Enter")?e.search(r):null}},model:{value:e.value,callback:function(r){e.value=r},expression:"value"}},[t("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:e.search},slot:"append"})],1)],1),e._v(" "),t("el-form-item",[t("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-edit"},on:{click:e.addUser}},[e._v("添加")])],1)],1),e._v(" "),t("wl-table",{ref:"table",attrs:{columns:e.columns},on:{callServe:e.callServe}}),e._v(" "),t("add-user-dialog",{attrs:{visible:e.addUserDialogVisible,user:e.currentEditUser},on:{"update:visible":function(r){e.addUserDialogVisible=r},confirm:e.confirm,close:e.close}})],1)},staticRenderFns:[]};var b=t("VU/8")(p,v,!1,function(e){t("N17M")},null,null);r.default=b.exports}});
//# sourceMappingURL=7.d048fb5b64617067b69b.js.map